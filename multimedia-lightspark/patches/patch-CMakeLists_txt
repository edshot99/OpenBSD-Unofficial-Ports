Index: CMakeLists.txt
--- CMakeLists.txt.orig	Fri Mar  1 14:20:21 2024
+++ CMakeLists.txt	Sun Mar  3 04:57:02 2024
@@ -326,22 +326,22 @@ IF(ENABLE_LIBAVCODEC)
   SET(CMAKE_REQUIRED_FLAGS ${FFMPEG_FLAGS})
   SET(CMAKE_REQUIRED_INCLUDES ${FFMPEG_INCLUDE_DIRS})
   SET(CMAKE_REQUIRED_LIBRARIES ${FFMPEG_LIBRARIES})
-  CHECK_FUNCTION_EXISTS(avcodec_decode_video2 HAVE_AVCODEC_DECODE_VIDEO2)
-  CHECK_FUNCTION_EXISTS(avcodec_decode_audio3 HAVE_AVCODEC_DECODE_AUDIO3)
-  CHECK_FUNCTION_EXISTS(avcodec_decode_audio4 HAVE_AVCODEC_DECODE_AUDIO4)
-  CHECK_FUNCTION_EXISTS(avio_alloc_context HAVE_AVIO_ALLOC_CONTEXT)
-  CHECK_FUNCTION_EXISTS(avcodec_alloc_context3 HAVE_AVCODEC_ALLOC_CONTEXT3)
-  CHECK_FUNCTION_EXISTS(avcodec_open2 HAVE_AVCODEC_OPEN2)
-  CHECK_FUNCTION_EXISTS(avformat_close_input HAVE_AVFORMAT_CLOSE_INPUT)
-  CHECK_FUNCTION_EXISTS(avformat_find_stream_info HAVE_AVFORMAT_FIND_STREAM_INFO)
-  CHECK_FUNCTION_EXISTS(av_frame_alloc HAVE_AV_FRAME_ALLOC)
-  CHECK_FUNCTION_EXISTS(av_frame_unref HAVE_AV_FRAME_UNREF)
-  CHECK_FUNCTION_EXISTS(av_packet_unref HAVE_AV_PACKET_UNREF)
-  CHECK_FUNCTION_EXISTS(avcodec_send_packet HAVE_AVCODEC_SEND_PACKET)
-  CHECK_FUNCTION_EXISTS(avcodec_receive_frame HAVE_AVCODEC_RECEIVE_FRAME)
-  CHECK_FUNCTION_EXISTS(av_frame_get_sample_rate HAVE_AV_FRAME_GET_SAMPLE_RATE)
+  SET(HAVE_AVCODEC_DECODE_VIDEO2 1)
+  SET(HAVE_AVCODEC_DECODE_AUDIO3 0)
+  SET(HAVE_AVCODEC_DECODE_AUDIO4 1)
+  SET(HAVE_AVIO_ALLOC_CONTEXT 1)
+  SET(HAVE_AVCODEC_ALLOC_CONTEXT3 1)
+  SET(HAVE_AVCODEC_OPEN2 1)
+  SET(HAVE_AVFORMAT_CLOSE_INPUT 1)
+  SET(HAVE_AVFORMAT_FIND_STREAM_INFO 1)
+  SET(HAVE_AV_FRAME_ALLOC 1)
+  SET(HAVE_AV_FRAME_UNREF 1)
+  SET(HAVE_AV_PACKET_UNREF 1)
+  SET(HAVE_AVCODEC_SEND_PACKET 1)
+  SET(HAVE_AVCODEC_RECEIVE_FRAME 1)
+  SET(HAVE_AV_FRAME_GET_SAMPLE_RATE 1)
 
-  CHECK_C_SOURCE_COMPILES("#include <libavcodec/avcodec.h>\nint main() { enum AVCodecID c; return 0; }" HAVE_AVCODECID)
+  SET(HAVE_AVCODECID 1)
 
   SET(CMAKE_REQUIRED_FLAGS)
   SET(CMAKE_REQUIRED_INCLUDES)
